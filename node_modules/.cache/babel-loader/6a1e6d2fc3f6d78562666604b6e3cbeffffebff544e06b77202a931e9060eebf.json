{"ast":null,"code":"import _slicedToArray from\"/Users/hooni/Desktop/upten/jooda/www.jooda.org/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useCallback,useEffect,useState}from'react';var numRows=3;var ableMatrix=[[true,true,true,true,true,true,true],[true,true,true,true,true,true,true],[true,true,true,true,true,true,true]];export var useWeek=function useWeek(week,calendarList,year,month){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),weekStartDate=_useState2[0],setWeekStartDate=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),weekEndDate=_useState4[0],setWeekEndDate=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),weekSchedule=_useState6[0],setWeekSchedule=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),weekData=_useState8[0],setWeekData=_useState8[1];var getScheduleLength=useCallback(function(start_date,end_date){if(end_date.length===0){return 1;}else{var startDate=new Date(start_date);var endDate=new Date(end_date);var diff=endDate.getTime()-startDate.getTime();return diff===0?1:diff/(1000*60*60*24)+1;}},[]);var getLocation=useCallback(function(length,ableMatrix,startX){for(var y=0;y<numRows;y++){var count=0;for(var x=startX;x<startX+length;x++){if(ableMatrix[y][x]){count=count+1;if(count===length){for(var i=0;i<length;i++){ableMatrix[y][startX+i]=false;}return{y:y};}continue;}}}return{y:-1};},[]);var getWeekSchedule=useCallback(function(){var results=[];calendarList&&calendarList.map(function(schedule){if(weekStartDate.length!==0&&weekEndDate.length!==0){if(weekStartDate<=schedule.start_date&&schedule.start_date<=weekEndDate||schedule.end_date.length!==0&&weekStartDate<=schedule.end_date&&schedule.end_date<=weekEndDate||schedule.end_date.length!==0&&weekStartDate>=schedule.start_date&&weekEndDate<=schedule.end_date){var start_date=weekStartDate>schedule.start_date?weekStartDate:schedule.start_date;results.push({church_calendar_id:schedule.church_calendar_id,title:schedule.title,content:schedule.content,start_date:start_date,end_date:weekEndDate<schedule.end_date?weekEndDate:schedule.end_date,is_current_month:schedule.is_current_month,x:getScheduleLength(weekStartDate,start_date)-1,y:0,length:0});}}});setWeekSchedule(results);},[calendarList,getScheduleLength,weekEndDate,weekStartDate]);var findLocationSchedule=function findLocationSchedule(ableMatrix){var results=[];weekSchedule.map(function(schedule){var scheduleLength=getScheduleLength(schedule.start_date,schedule.end_date);var _getLocation=getLocation(scheduleLength,ableMatrix,schedule.x),y=_getLocation.y;if(y!==-1){results.push({church_calendar_id:schedule.church_calendar_id,title:schedule.title,content:schedule.content,start_date:schedule.start_date,end_date:schedule.end_date,is_current_month:schedule.is_current_month,x:schedule.x,y:y,length:scheduleLength});}});setWeekData(results);};useEffect(function(){var start_year=week[0].year.toString();var start_month=week[0].month.toString();start_month=start_month.length===2?start_month:'0'+start_month;var start_date=week[0].date.toString();start_date=start_date.length===2?start_date:'0'+start_date;setWeekStartDate(start_year+'-'+start_month+'-'+start_date);var end_year=week[6].year.toString();var end_month=week[6].month.toString();end_month=end_month.length===2?end_month:'0'+end_month;var end_date=week[6].date.toString();end_date=end_date.length===2?end_date:'0'+end_date;setWeekEndDate(end_year+'-'+end_month+'-'+end_date);},[week,year,month]);useEffect(function(){if(weekStartDate.length!==0&&weekEndDate.length!==0){getWeekSchedule();}},[weekStartDate,weekEndDate,getWeekSchedule]);useEffect(function(){findLocationSchedule(JSON.parse(JSON.stringify(ableMatrix)));},[weekSchedule]);return{weekData:weekData};};","map":{"version":3,"names":["useCallback","useEffect","useState","numRows","ableMatrix","useWeek","week","calendarList","year","month","_useState","_useState2","_slicedToArray","weekStartDate","setWeekStartDate","_useState3","_useState4","weekEndDate","setWeekEndDate","_useState5","_useState6","weekSchedule","setWeekSchedule","_useState7","_useState8","weekData","setWeekData","getScheduleLength","start_date","end_date","length","startDate","Date","endDate","diff","getTime","getLocation","startX","y","count","x","i","getWeekSchedule","results","map","schedule","push","church_calendar_id","title","content","is_current_month","findLocationSchedule","scheduleLength","_getLocation","start_year","toString","start_month","date","end_year","end_month","JSON","parse","stringify"],"sources":["/Users/hooni/Desktop/upten/jooda/www.jooda.org/src/hooks/useWeek.ts"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react'\n\ninterface Date {\n  date: number\n  month: number\n  year: number\n}\ninterface ReturnCalendarList {\n  church_calendar_id: string\n  title: string\n  content: string\n  start_date: string\n  end_date: string\n  is_current_month: boolean\n  x: number\n  y: number\n  length: number\n}\n\nexport interface CalendarList {\n  church_calendar_id: string\n  title: string\n  content: string\n  start_date: string\n  end_date: string\n  is_current_month: boolean\n}\nconst numRows = 3\nconst ableMatrix = [\n  [true, true, true, true, true, true, true],\n  [true, true, true, true, true, true, true],\n  [true, true, true, true, true, true, true],\n]\nexport const useWeek = (\n  week: Array<Date>,\n  calendarList: Array<CalendarList>,\n  year: number,\n  month: number\n) => {\n  const [weekStartDate, setWeekStartDate] = useState<string>('')\n  const [weekEndDate, setWeekEndDate] = useState<string>('')\n  const [weekSchedule, setWeekSchedule] = useState<ReturnCalendarList[]>([])\n  const [weekData, setWeekData] = useState<ReturnCalendarList[]>([])\n\n  const getScheduleLength = useCallback(\n    (start_date: string, end_date: string) => {\n      if (end_date.length === 0) {\n        return 1\n      } else {\n        var startDate = new Date(start_date)\n        var endDate = new Date(end_date)\n        var diff = endDate.getTime() - startDate.getTime()\n        return diff === 0 ? 1 : diff / (1000 * 60 * 60 * 24) + 1\n      }\n    },\n    []\n  )\n  const getLocation = useCallback(\n    (length: number, ableMatrix: boolean[][], startX: number) => {\n      for (let y = 0; y < numRows; y++) {\n        var count = 0\n        for (let x = startX; x < startX + length; x++) {\n          if (ableMatrix[y][x]) {\n            count = count + 1\n            if (count === length) {\n              for (let i = 0; i < length; i++) {\n                ableMatrix[y][startX + i] = false\n              }\n              return {\n                y: y,\n              }\n            }\n            continue\n          }\n        }\n      }\n      return {\n        y: -1,\n      }\n    },\n    []\n  )\n\n  const getWeekSchedule = useCallback(() => {\n    const results: ReturnCalendarList[] = []\n    calendarList &&\n      calendarList.map(schedule => {\n        if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n          if (\n            (weekStartDate <= schedule.start_date &&\n              schedule.start_date <= weekEndDate) ||\n            (schedule.end_date.length !== 0 &&\n              weekStartDate <= schedule.end_date &&\n              schedule.end_date <= weekEndDate) ||\n            (schedule.end_date.length !== 0 &&\n              weekStartDate >= schedule.start_date &&\n              weekEndDate <= schedule.end_date)\n          ) {\n            var start_date =\n              weekStartDate > schedule.start_date\n                ? weekStartDate\n                : schedule.start_date\n            results.push({\n              church_calendar_id: schedule.church_calendar_id,\n              title: schedule.title,\n              content: schedule.content,\n              start_date: start_date,\n              end_date:\n                weekEndDate < schedule.end_date\n                  ? weekEndDate\n                  : schedule.end_date,\n              is_current_month: schedule.is_current_month,\n              x: getScheduleLength(weekStartDate, start_date) - 1,\n              y: 0,\n              length: 0,\n            })\n          }\n        }\n      })\n\n    setWeekSchedule(results)\n  }, [calendarList, getScheduleLength, weekEndDate, weekStartDate])\n\n  const findLocationSchedule = (ableMatrix: boolean[][]) => {\n    const results: ReturnCalendarList[] = []\n    weekSchedule.map(schedule => {\n      const scheduleLength = getScheduleLength(\n        schedule.start_date,\n        schedule.end_date\n      )\n      const { y } = getLocation(scheduleLength, ableMatrix, schedule.x)\n      if (y !== -1) {\n        results.push({\n          church_calendar_id: schedule.church_calendar_id,\n          title: schedule.title,\n          content: schedule.content,\n          start_date: schedule.start_date,\n          end_date: schedule.end_date,\n          is_current_month: schedule.is_current_month,\n          x: schedule.x,\n          y: y,\n          length: scheduleLength,\n        })\n      }\n    })\n\n    setWeekData(results)\n  }\n\n  useEffect(() => {\n    var start_year = week[0].year.toString()\n    var start_month = week[0].month.toString()\n    start_month = start_month.length === 2 ? start_month : '0' + start_month\n    var start_date = week[0].date.toString()\n    start_date = start_date.length === 2 ? start_date : '0' + start_date\n    setWeekStartDate(start_year + '-' + start_month + '-' + start_date)\n    var end_year = week[6].year.toString()\n    var end_month = week[6].month.toString()\n    end_month = end_month.length === 2 ? end_month : '0' + end_month\n    var end_date = week[6].date.toString()\n    end_date = end_date.length === 2 ? end_date : '0' + end_date\n    setWeekEndDate(end_year + '-' + end_month + '-' + end_date)\n  }, [week, year, month])\n\n  useEffect(() => {\n    if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n      getWeekSchedule()\n    }\n  }, [weekStartDate, weekEndDate, getWeekSchedule])\n\n  useEffect(() => {\n    findLocationSchedule(JSON.parse(JSON.stringify(ableMatrix)))\n  }, [weekSchedule])\n\n  return { weekData }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}