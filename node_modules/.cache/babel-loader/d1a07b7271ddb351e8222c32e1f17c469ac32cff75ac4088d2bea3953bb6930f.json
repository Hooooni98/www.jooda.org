{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useState } from 'react';\nconst numRows = 3;\nconst ableMatrix = [[true, true, true, true, true, true, true], [true, true, true, true, true, true, true], [true, true, true, true, true, true, true]];\nexport const useWeek = (week, calendarList) => {\n  _s();\n  const [weekStartDate, setWeekStartDate] = useState('');\n  const [weekEndDate, setWeekEndDate] = useState('');\n  const [weekSchedule, setWeekSchedule] = useState([]);\n  const [weekData, setWeekData] = useState([]);\n  const getScheduleLength = useCallback((start_date, end_date) => {\n    if (end_date.length === 0) {\n      return 1;\n    } else {\n      var startDate = new Date(start_date);\n      var endDate = new Date(end_date);\n      var diff = endDate.getTime() - startDate.getTime();\n      return diff === 0 ? 1 : diff / (1000 * 60 * 60 * 24) + 1;\n    }\n  }, []);\n  const getLocation = useCallback(async (length, ableMatrix, startX) => {\n    for (let y = 0; y < numRows; y++) {\n      var count = 0;\n      for (let x = startX; x < startX + length; x++) {\n        if (ableMatrix[y][x]) {\n          count = count + 1;\n          if (count === length) {\n            for (let i = 0; i < length; i++) {\n              ableMatrix[y][startX + i] = false;\n            }\n            return {\n              y: y\n            };\n          }\n          continue;\n        }\n      }\n    }\n    return {\n      y: -1\n    };\n  }, []);\n  const getWeekSchedule = useCallback(() => {\n    const results = [];\n    calendarList.map(schedule => {\n      if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n        if (weekStartDate <= schedule.start_date && schedule.start_date <= weekEndDate || schedule.end_date.length !== 0 && weekStartDate <= schedule.end_date && schedule.end_date <= weekEndDate) {\n          var start_date = weekStartDate > schedule.start_date ? weekStartDate : schedule.start_date;\n          results.push({\n            church_calendar_id: schedule.church_calendar_id,\n            title: schedule.title,\n            content: schedule.content,\n            start_date: start_date,\n            end_date: weekEndDate < schedule.end_date ? weekEndDate : schedule.end_date,\n            is_current_month: schedule.is_current_month,\n            x: getScheduleLength(weekStartDate, start_date) - 1,\n            y: 0,\n            length: 0\n          });\n        }\n      }\n    });\n    setWeekSchedule(results);\n  }, [calendarList, getScheduleLength, weekEndDate, weekStartDate]);\n  const findLocationSchedule = useCallback(ableMatrix => {\n    // const ableMatrix = getAbleMarix()\n    const results = [];\n    weekSchedule.map(async schedule => {\n      const scheduleLength = getScheduleLength(schedule.start_date, schedule.end_date);\n      const {\n        y\n      } = await getLocation(scheduleLength, ableMatrix, schedule.x);\n      if (y !== -1) {\n        results.push({\n          church_calendar_id: schedule.church_calendar_id,\n          title: schedule.title,\n          content: schedule.content,\n          start_date: schedule.start_date,\n          end_date: schedule.end_date,\n          is_current_month: schedule.is_current_month,\n          x: schedule.x,\n          y: y,\n          length: scheduleLength\n        });\n      }\n    });\n    setWeekData(results);\n  }, [getLocation, getScheduleLength, weekSchedule]);\n  useEffect(() => {\n    var start_year = week[0].year.toString();\n    var start_month = week[0].month.toString();\n    start_month = start_month.length === 2 ? start_month : '0' + start_month;\n    var start_date = week[0].date.toString();\n    start_date = start_date.length === 2 ? start_date : '0' + start_date;\n    setWeekStartDate(start_year + '-' + start_month + '-' + start_date);\n    var end_year = week[6].year.toString();\n    var end_month = week[6].month.toString();\n    end_month = end_month.length === 2 ? end_month : '0' + end_month;\n    var end_date = week[6].date.toString();\n    end_date = end_date.length === 2 ? end_date : '0' + end_date;\n    setWeekEndDate(end_year + '-' + end_month + '-' + end_date);\n  }, [week]);\n  useEffect(() => {\n    if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n      getWeekSchedule();\n    }\n  }, [weekStartDate, weekEndDate, getWeekSchedule]);\n  useEffect(() => {\n    if (weekSchedule.length !== 0) {\n      findLocationSchedule([...ableMatrix]);\n    }\n  }, [findLocationSchedule, weekSchedule]);\n  return {\n    weekData\n  };\n};\n_s(useWeek, \"Q6MbPP+VbADeSGrq7HYVzVBHtIk=\");","map":{"version":3,"names":["useCallback","useEffect","useState","numRows","ableMatrix","useWeek","week","calendarList","_s","weekStartDate","setWeekStartDate","weekEndDate","setWeekEndDate","weekSchedule","setWeekSchedule","weekData","setWeekData","getScheduleLength","start_date","end_date","length","startDate","Date","endDate","diff","getTime","getLocation","startX","y","count","x","i","getWeekSchedule","results","map","schedule","push","church_calendar_id","title","content","is_current_month","findLocationSchedule","scheduleLength","start_year","year","toString","start_month","month","date","end_year","end_month"],"sources":["/Users/hooni/Desktop/upten/jooda/www.jooda.org/src/hooks/useWeek.ts"],"sourcesContent":["import { useCallback, useEffect, useRef, useState } from 'react'\n\ninterface Date {\n  date: number\n  month: number\n  year: number\n}\ninterface ReturnCalendarList {\n  church_calendar_id: string\n  title: string\n  content: string\n  start_date: string\n  end_date: string\n  is_current_month: boolean\n  x: number\n  y: number\n  length: number\n}\n\ninterface CalendarList {\n  church_calendar_id: string\n  title: string\n  content: string\n  start_date: string\n  end_date: string\n  is_current_month: boolean\n}\nconst numRows = 3\nconst ableMatrix = [\n  [true, true, true, true, true, true, true],\n  [true, true, true, true, true, true, true],\n  [true, true, true, true, true, true, true],\n]\nexport const useWeek = (\n  week: Array<Date>,\n  calendarList: Array<CalendarList>\n) => {\n  const [weekStartDate, setWeekStartDate] = useState<string>('')\n  const [weekEndDate, setWeekEndDate] = useState<string>('')\n  const [weekSchedule, setWeekSchedule] = useState<ReturnCalendarList[]>([])\n  const [weekData, setWeekData] = useState<ReturnCalendarList[]>([])\n\n  const getScheduleLength = useCallback(\n    (start_date: string, end_date: string) => {\n      if (end_date.length === 0) {\n        return 1\n      } else {\n        var startDate = new Date(start_date)\n        var endDate = new Date(end_date)\n        var diff = endDate.getTime() - startDate.getTime()\n        return diff === 0 ? 1 : diff / (1000 * 60 * 60 * 24) + 1\n      }\n    },\n    []\n  )\n  const getLocation = useCallback(\n    async (length: number, ableMatrix: boolean[][], startX: number) => {\n      for (let y = 0; y < numRows; y++) {\n        var count = 0\n        for (let x = startX; x < startX + length; x++) {\n          if (ableMatrix[y][x]) {\n            count = count + 1\n            if (count === length) {\n              for (let i = 0; i < length; i++) {\n                ableMatrix[y][startX + i] = false\n              }\n              return {\n                y: y,\n              }\n            }\n            continue\n          }\n        }\n      }\n      return {\n        y: -1,\n      }\n    },\n    []\n  )\n\n  const getWeekSchedule = useCallback(() => {\n    const results: ReturnCalendarList[] = []\n    calendarList.map(schedule => {\n      if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n        if (\n          (weekStartDate <= schedule.start_date &&\n            schedule.start_date <= weekEndDate) ||\n          (schedule.end_date.length !== 0 &&\n            weekStartDate <= schedule.end_date &&\n            schedule.end_date <= weekEndDate)\n        ) {\n          var start_date =\n            weekStartDate > schedule.start_date\n              ? weekStartDate\n              : schedule.start_date\n          results.push({\n            church_calendar_id: schedule.church_calendar_id,\n            title: schedule.title,\n            content: schedule.content,\n            start_date: start_date,\n            end_date:\n              weekEndDate < schedule.end_date ? weekEndDate : schedule.end_date,\n            is_current_month: schedule.is_current_month,\n            x: getScheduleLength(weekStartDate, start_date) - 1,\n            y: 0,\n            length: 0,\n          })\n        }\n      }\n    })\n\n    setWeekSchedule(results)\n  }, [calendarList, getScheduleLength, weekEndDate, weekStartDate])\n\n  const findLocationSchedule = useCallback(\n    (ableMatrix: boolean[][]) => {\n      // const ableMatrix = getAbleMarix()\n      const results: ReturnCalendarList[] = []\n      weekSchedule.map(async schedule => {\n        const scheduleLength = getScheduleLength(\n          schedule.start_date,\n          schedule.end_date\n        )\n        const { y } = await getLocation(scheduleLength, ableMatrix, schedule.x)\n        if (y !== -1) {\n          results.push({\n            church_calendar_id: schedule.church_calendar_id,\n            title: schedule.title,\n            content: schedule.content,\n            start_date: schedule.start_date,\n            end_date: schedule.end_date,\n            is_current_month: schedule.is_current_month,\n            x: schedule.x,\n            y: y,\n            length: scheduleLength,\n          })\n        }\n      })\n\n      setWeekData(results)\n    },\n    [getLocation, getScheduleLength, weekSchedule]\n  )\n\n  useEffect(() => {\n    var start_year = week[0].year.toString()\n    var start_month = week[0].month.toString()\n    start_month = start_month.length === 2 ? start_month : '0' + start_month\n    var start_date = week[0].date.toString()\n    start_date = start_date.length === 2 ? start_date : '0' + start_date\n    setWeekStartDate(start_year + '-' + start_month + '-' + start_date)\n    var end_year = week[6].year.toString()\n    var end_month = week[6].month.toString()\n    end_month = end_month.length === 2 ? end_month : '0' + end_month\n    var end_date = week[6].date.toString()\n    end_date = end_date.length === 2 ? end_date : '0' + end_date\n    setWeekEndDate(end_year + '-' + end_month + '-' + end_date)\n  }, [week])\n\n  useEffect(() => {\n    if (weekStartDate.length !== 0 && weekEndDate.length !== 0) {\n      getWeekSchedule()\n    }\n  }, [weekStartDate, weekEndDate, getWeekSchedule])\n\n  useEffect(() => {\n    if (weekSchedule.length !== 0) {\n      findLocationSchedule([...ableMatrix])\n    }\n  }, [findLocationSchedule, weekSchedule])\n\n  return { weekData }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}